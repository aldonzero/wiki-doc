# HTTP

## 1. HTTP 基本概念
超文本传输协议：是一个应用层的简单的请求-响应传输协议。

## 2. Get 与 Post
- 一般来说，get从服务器获取资源，post向服务器发送资源
- get中携带的数据有限（url长度有限）， post中的请求体能携带更多的数据
- get只能发送ASCII字符，post支持更多的类型
- post在发送数据之前会将请求头发送给服务器进行验证，get不会进行验证。（get会比post更快）
- get会缓存数据（IE中全部缓存，chrome和firefox只会缓存静态资源），post不会

安全和幂等：在Http中的安全是指不会破坏服务器上的资源，幂等是指多次执行操作的结果是相同的。
从这个角度说get是安全和幂等的，post不是

## 2. HTTP 特性
- 简单：报文格式是header+body
- 灵活易于扩展：HTTP封装了各种请求方法、URI/URL、状态码、头字段等，每个组成的要求都没有被固定，允许开发人员自定义扩充。
- 应用广泛和跨平台
- 无状态，明文传输：无状态是指每个请求都是独立，如果后面要处理前面的信息，则前面的信息需要重传。无状态的好处，服务器不会去记忆额外的状态信息可以减轻服务器的压力。
- 明文传输不安全，不加密可能被窃听；不验证通信方的身份信息可能遭遇伪装；无法证明报文的完整性，报文可能被篡改。

## 3. HTTPS 与 HTTP
- http明文传输，存在风险；https在tcp和http之间添加了SSL/TLS协议，使得报文能够加密传输；
- 握手：http三次握手后便可以传输数据；在http三次握手的基础上还需要SSL/TLS握手过程才可以传输数据。
- 端口：http80， https443；
- https需要向CA（证书权威机构）申请证书，来保证服务器的身份是可信的。

## 4. HTTP/1.1、HTTP/2、HTTP/3 演变 

 **http1.1在http1.0上的改进：**  
- 采用长连接，一次tcp连接可以发送多个请求
- 支持管道传输，可以连续发送多个请求，不必等前一个请求响应。

 **http2在http1.1上的改进：** 
- 头部压缩：如果发出的多个请求头部是相同的或相似的，协议可以帮助消除重复部分。（使用HPACK算法实现：在客户端和服务器同时维护一张头信息表，所有字段都会存入这个表，生成一个索引号，以后就不发送同样字段了，只发送索引号，这样就提高速度了）

- http1.1是纯文本形成的报文，而http2是二进制格式，计算机可以直接解析二进制报文，可以提高效率。

  ​

  ![输入图片说明](https://foruda.gitee.com/images/1678159964975571432/18f736bc_8616658.png "屏幕截图")

  ​

- 数据流：每个请求或响应的所有数据包称为一个数据流。同一个连接有连续的数据包，可能属于不同的响应。因此需要对数据包做标记，指出属于哪个响应。

- 多路复用：同一个连接可以发送多个请求，服务端也可以连续多个响应，响应可以不按照请求的顺序。

  ​

  ![输入图片说明](https://foruda.gitee.com/images/1678170739829247406/f99d10dd_8616658.png "屏幕截图")

  ​

- 服务器推送：服务端可以向客户端主动发送消息。例如，服务端响应客户端请求时，可以主动将客户端可能用到的静态资源发送给客户端。

 **http1.1的缺点：** 管道传输中如果有一个队列阻塞了，那么后续的所有请求也被阻塞了。
 **http2的缺点：** 多个http复用一个tcp连接，一旦发生丢包就会阻塞住所有的http请求。

 **http3的改进：** 
- http下层的 TCP 协议改成了基于UDP实现的QUIC协议可以实现类似tcp的可靠传输

- QUIC协议发生丢包时只会阻塞这个流，其他流不会受到影响。

- TL3 升级成了最新的 1.3 版本，头部压缩算法也升级成了 QPack

- HTTPS 要建立一个连接，要花费 6 次交互，先是建立三次握手，然后是 TLS/1.3 的三次握手。QUIC 直接把以往的 TCP 和 TLS/1.3 的 6 次交互合并成了 3 次，减少了交互次数
   **http3的问题：** QUIC 是新协议，对于很多网络设备，根本不知道什么是 QUIC，只会当做 UDP，这样会出现新的问题。

   ​

   ![输入图片说明](https://foruda.gitee.com/images/1678172546798421361/6bebac4c_8616658.png "屏幕截图")
   ![输入图片说明](https://foruda.gitee.com/images/1678172564770254221/c16294c8_8616658.png "屏幕截图")

![输入图片说明](https://foruda.gitee.com/images/1678158183940999574/a14f0804_8616658.png "屏幕截图")

 **管道传输** ：在同一个 TCP 连接里面，客户端可以发起多个请求，只要第一个请求发出去了，不必等其回来，就可以发第二个请求出去，可以减少整体的响应时间。

![输入图片说明](https://foruda.gitee.com/images/1678158650204850189/775acc40_8616658.png "屏幕截图")

队头阻塞：当顺序发送的请求序列中的一个请求因为某种原因被阻塞时，在后面排队的所有请求也一同被阻塞了，会招致客户端一直请求不到数据，这也就是「队头阻塞」

![输入图片说明](https://foruda.gitee.com/images/1678158694278364369/a1193c4e_8616658.png "屏幕截图")