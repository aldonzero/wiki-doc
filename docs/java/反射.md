## 1、什么是反射？

反射是在**运行状态中**，对**任意一个类**都能够知道这个类的**所有方法和属性**；对于**任意一个对象**，都能调用它**任意方法和属性**；这种动态获取信息以及动态调用对象方法的功能称为Java的反射机制。

## 2、反射机制的优缺点？

**优点：**能动态获取对象的实例，提高灵活性；可于动态编译集合。

如，`Class.forName('com.mysql.jdbc.Driver.class');` ，加载MySQL的驱动类。

**缺点：**使用反射性**能较低**，需要解析字节码，将内存中的对象进行解析。

其解决方案是：

- 通过`setAccessible(true)`关闭JDK的安全检查来提升反射速度；
- 多次创建一个类的实例时，有缓存会快很多；
- ReflflectASM工具类，通过字节码生成的方式加快反射速度。

## 3、如何获取反射中的Class对象？

1. `Class.forName(“类的路径”)；`当知道该类的全路径名时，你可以使用该方法获取 Class 类对象。

   ```java
   Class clz = Class.forName("java.lang.String");
   ```

2. `类名.class`这种方法只适合在编译前就知道操作的 Class。

   ```java
   Class clz = String.class
   ```

3. `对象名.getClass()`。

   ```java
   String str = new String("Hello");
   Class clz = str.getClass();
   ```

4.  如果是基本类型的`包装类`，可以调用包装类的`Type属性`来获得该包装类的Class对象。

   ```java
   Class clz = Integer.TYPE;
   ```

## 4、Java反射API有几类？

反射 API 用来生成 JVM 中的类、接口或则对象的信息。

- Class 类：反射的核心类，可以获取**类的属性，方法**等信息；
- Field 类：Java.lang.reflec 包中的类，表示类的**成员变量**，可以用来**获取和设置**类之中的属性值；
- Method 类：Java.lang.reflec 包中的类，表示**类的方法**，它可以用来**获取**类中的方法信息或者**执行**方法；
- Constructor 类：Java.lang.reflec 包中的类，表示类的**构造方法**。

## 5、反射使用步骤

1. 获取想要操作的类的Class对象，这是反射的核心，通过Class对象我们可以任意调用类的方法。
2. 调用 Class 类中的方法，既就是反射的使用阶段。
3. 使用反射 API 来操作这些信息。

```java
import java.lang.reflect.Constructor;
import java.lang.reflect.Method;

public class Main {
    public void print(String manner) {
        System.out.println(manner);
    }

    public static void main(String[] args) throws Exception {
        //正常调用
        Main main = new Main();
        main.print("正常调用");
        //反射调用
        //1、获取class对象
        Class clz = Class.forName("Main");
        //2、获取方法
        Method mainPrint = clz.getMethod("print", String.class);
        //3、获取构造方法
        Constructor constructorMain = clz.getConstructor();
        //4、创建对象实例
        Object newMain = constructorMain.newInstance();
        //5、方法调用
        mainPrint.invoke(newMain, "反射调用");
    }
}
```

## 6、为什么引入反射概念？反射机制的应用有哪些？

反射主要应用在以下几方面：

- 反射让开发人员可以通过外部类的全路径名**创建对象**，并使用这些类，实现一些扩展的功能。
- 反射让开发人员可以**枚举出类的全部成员**，包括构造函数、属性、方法。以帮助开发者写出正确的代码。
- 测试时可以利用反射 API **访问类的私有成员**，以保证测试代码覆盖率

第一种：JDBC 的数据库的连接。

在JDBC 的操作中，如果要想进行数据库的连接，则必须按照以上的几步完成

1. 通过Class.forName()加载数据库的驱动程序 （通过反射加载，前提是引入相关了Jar包）；
2. 通过 DriverManager 类进行数据库的连接，连接的时候要输入数据库的连接地址、用户名、密码；
3. 通过Connection 接口接收连接。

第二种：Spring 框架的使用，最经典的就是xml的配置模式。

Spring 通过 XML 配置模式装载 Bean 的过程：

1. 将程序内所有 XML 或 Properties 配置文件加载入内存中；
2. Java类里面解析xml或properties里面的内容，得到对应实体类的字节码字符串以及相关的属性信
     息；
3. 使用反射机制，根据这个字符串获得某个类的Class实例；
4. 动态配置实例的属性。

Spring这样做的好处是：

- 不用每一次都要在代码里面去new或者做其他的事情；
- 以后要改的话直接改配置文件，代码维护起来就很方便了；
- 有时为了适应某些需求，Java类里面不一定能直接调用另外的方法，可以通过反射机制来实现。