# Java

## Java基础

### String相关

#### 1、String为什么设计成不可变？ 

1. 便于是实现字符串池（String Pool）

   在Java中会大量使用字符串常量，如果每声明一个String都创建一个String对象，那将会造成极大的空间资源的浪费。

   Java中提出String pool的概念，在堆中开辟一块字符串常量池存储空间，当初始化一个String常量时，如果该字符串已经存在，不会在空间中新创建一个字符串，而会返回一个字符串引用。

   如果字符串是可变的，某个字符串改变了值，那其他指向的该字符串的值也会改变，String pool将无法实现。

2. 多线程安全

   首先，这里多线程安全是指，多个线程调用对象的方法是线程安全的。

   在并发场景下，使得资源不可被写，保证了线程安全。

3. 避免线程安全问题

   在网络连接和数据库连接中字符串常常作为参数，如网络连接地址URL，文件路径path，反射机制所需要的String参数。其不可变性，保证了连接安全。

4. 加快字符串处理速度

   由于String是不可变的，保证了hash code的唯一性，于是在创建对象时，hashcode可以放心放入缓存，不需要重新计算。

#### 2、常量池分类？区别？[ref](/java/常量池)

### 反射相关   [ref](/java/反射)

1. 什么是反射？
2. 反射机制的优缺点？
3. 如何获取反射中的Class对象？
4. Java反射API有几类？
5. 反射使用步骤
6. 为什么引入反射概念？反射机制的应用有哪些？

### 异常相关   [ref](/java/Error&Exception)

1. Error 和 Exception 区别是什么？
2. 非受检查异常(运行时异常)和受检查异常(一般异常)区别是什么？
3. throw 和 throws 的区别是什么?
4. try-catch-finally 中哪个部分可以省略？
5. try-catch-finally 中，如果 catch 中 return 了，finally 还会执行吗？
6. JVM 是如何处理异常的？



## MySQL相关

### 1. 索引

1. 索引是什么？

   索引是帮助存储引擎快速获取数据的一种**数据结构**，用于加速数据表的数据检索。

2. 索引有哪些优缺点？

   优点：加速数据表的数据检索。

   缺点：索引是一种数据结构会需要存储空间，当面对写多读少的场景时，过多的索引会降低数据库的性能。

3. MySQL有哪几种索引类型？

   从数据结构的角度看，索引有Hash索引、B+Tree索引、Full-Text索引。

4. 说一说索引的底层实现？

   B+Tree索引时一种多叉树，叶子节点存放数据，非叶子节点只存放索引，而且每个节点里的数据是按主键顺序放存放的。每层父节点的索引值都会出现在下层子节点的索引值中，因此在叶子节点中，包括了所有的索引值信息，并且每一个叶子节点都有两个指针，分别指向下一个叶子节点和上一个叶子节点，形成一个双向链表。

5. 为什么索引结构默认使用B+Tree，而不是B-Tree，Hash，二叉树，红黑树？

   - Hash索引虽然能快速查询，但是不支持范围查询。
   - 二叉树，在某些情况下会退化成链表，这种情况相当于全表扫描，时间复杂度为O（N）；二叉树的层级比较深，磁盘I/O次数比较多；
   - 平衡二叉树虽然解决了二叉树退化成链表问题，但是仍然存在层级深的问题，如果每个节点存放一页，磁盘IO效率的问题仍然没有解决，导致搜索效率不足。
   - 多路平衡查找树（b Tree），相较于平衡二叉树很好的利用了操作系统和磁盘交互的特性，层级降低了很多，但是非叶子节点也会存储数据，相较于B+Tree非叶子节点存储的索引会更少，访问磁盘的IO次数会更多。

6. 讲一讲聚簇索引与非聚簇索引？

   聚簇索引和非聚簇索引是不同的数据存储结构。

   聚簇索引（主键索引）：在叶子节点中会存储主键索引和所有行数据。

   非聚簇索引（二级索引）：在叶子节点中会存储主键索引和非聚簇索引所在列的数据。

   当查询是超出了非聚簇索引范围列时，会进行回表查询，即通二级索引查询到主键索引后，再通过主键查询相应的值。

7. 非聚簇索引一定会回表查询吗？

   不一定，只有要查询的列超过了非聚簇索引列的范围才会回表查询。

8. 联合索引是什么？为什么需要注意联合索引中的顺序？

   联合索引是将多个字段组合成一个索引。

   联合索引包含多个列，那么只有再查询条件中遵循最左匹配原则才能使索引生效，否则无法使用该索引。

9. 讲一讲MySQL的最左前缀原则?

   如果一个联合索引包含了（A、B）列，只有当使用了A列才能使用B列，如果查询语句中只使用了B列，那么该联合索引将无法被使用，也不能被查询优化器使用。最左匹配原则联合索引最左侧的列必须依次使用不能间断使用。

10. 讲一讲前缀索引？

  前缀索引是指对字符类型字段的前几个字符建立的索引，而不是再整个字段上建立索引。

11. 了解索引下推吗？

    ​

12. 怎么查看MySQL语句有没有用到索引？

    使用explain慢查询，查看MySQL语句使用了什么索引。

13. 为什么官方建议使用自增长主键作为索引？

    结合B+Tree的特点，自增主键时连续的，在插入过程中尽量减少页的分裂，即使要进行页的分裂，也只会分裂很少一部分；并且能减少数据的移动。每次插入都是插入到最后。

14. 如何创建索引？

    ```java
    // 1、创建表时表示索引
    create table tb_user)
      id int auto_increment primary key,
      id_card varchar(18),
      unique key (id_card)
    );
    // 2、使用Alter table命令增加索引
    alter table tb_user add index|primary key|unique|fulltext index_name (索引列);
    //3、使用create index命令创建
    create index index_name on tb_name (索引列)
    ```

    ​

    ​

15. 创建索引时需要注意什么？

    1. 字段一般为非空字段，除非想存储NULL，因为含有null值的列很难进行查询优化；
    2. 将区分度高的字段放索引前面，使用得多得字段放索引前面；
    3. 索引字段越小越好，数据可得存储是以页为单位，一页存储的数据越多，一次IO操作获取的数据效率越高。

16. 建索引的原则有哪些？

    1. 最左匹配原则，MySQL查询会一致向右匹配直到遇到范围查询（>、 <、between、like）就停止匹配，因此一般进行范围查询的索引放在最后；
    2. =和in可以乱序，MySQL查询优化器会帮你优化成索引可以识别的形式；
    3. 尽量选择区分度高的索引，使用比较多的索引放前面，区分度公式`count(distinct col)/count(*)`，表示字段不重复的比例；
    4. 索引列不能参与计算；
    5. 尽量的扩展索引，不要新建索引，尽量在原有索引的基础上修改索引。

17. 使用索引查询一定能提高查询的性能吗？

    不一定。

    - 索引需要空间存储，也需要定期维护，每当有记录在表中增减或索引列被修改时，索引本身也会被修改；那些不必要的索引反而会使得查询变慢。
    - 索引的范围查询一般适应两种情况：一是查询返回的结果集小于表中记录数的30%；而是基于非唯一性索引的检索。

    ​

18. 什么情况下不走索引（索引失效）？

    1、使用!= 或者 <> 导致索引失效

    2、类型不一致导致的索引失效

    3、函数导致的索引失效

    4、运算符导致的索引失效

    5、OR引起的索引失效

    6、模糊搜索导致的索引失效

    7、NOT IN、NOT EXISTS导致索引失效

    ​

### 2. 基础

1. 数据库的三范式是什么？
2. MySQL 支持哪些存储引擎?
3. 超键、候选键、主键、外键分别是什么？
4. SQL 约束有哪几种？
5. MySQL 中的 varchar 和 char 有什么区别？
6. MySQL中 in 和 exists 区别
7. drop、delete与truncate的区别
8. 什么是存储过程？有哪些优缺点？
9. MySQL 执行查询的过程

### 2. 事务

1. 什么是数据库事务？
2. 介绍一下事务具有的四个特征
3. 说一下MySQL 的四种隔离级别
4. 什么是脏读？幻读？不可重复读？
5. 事务的实现原理
6. MySQL事务日志介绍下？（redo log、undo log）
7. 什么是MySQL的 binlog？
8. 在事务中可以混合使用存储引擎吗？
9. MySQL中是如何实现事务隔离的?
10. 什么是 MVCC？
11. MVCC 的实现原理

### 3. 锁

1. 为什么要加锁?

2. 按照锁的粒度分数据库锁有哪些？

3. 从锁的类别上分MySQL都有哪些锁呢？

4. 数据库的乐观锁和悲观锁是什么？怎么实现的？

5. InnoDB引擎的行锁是怎么实现的？

6. 什么是死锁？怎么解决？

7. 隔离级别与锁的关系

8. 优化锁方面的意见？
      分库分表

9. 为什么要分库分表？

10. 用过哪些分库分表中间件？不同的分库分表中间件都有什么优点和缺点？
  cobar
  TDDL
  atlas
  sharding-jdbc
  mycat

11. 如何对数据库如何进行垂直拆分或水平拆分的？
       读写分离、主从同步（复制）

12. 什么是MySQL主从同步？

13. MySQL主从同步的目的？为什么要做主从同步？

14. 如何实现MySQL的读写分离？
       5

15. MySQL主从复制流程和原理？

16. MySQL主从同步延时问题如何解决？
       MySQL优化

17. 如何定位及优化SQL语句的性能问题？

18. 大表数据查询，怎么优化

19. 超大分页怎么处理?

20. 统计过慢查询吗？对慢查询都怎么优化过？

21. 如何优化查询过程中的数据访问

22. 如何优化关联查询

23. 数据库结构优化

24. MySQL数据库cpu飙升到500%的话他怎么处理？

25. 大表怎么优化？

## 计算机网络

### TCP相关   [ref](/计算机网络/tcp)

1、TCP概念

2、UDP 和 TCP 有什么区别呢？分别的应用场景是？

3、TCP三次握手过程

4、为什么是三次握手？

5、什么是 SYN 攻击？如何避免 SYN 攻击？

6、三次握手连接阶段，最后一次ACK包丢失，会发生什么？

7、四次挥手过程

8、为什么 TIME_WAIT 等待的时间是 2MSL？

9、如果已经建立了连接，但是客户端出现故障了怎么办？

10、TIME-WAIT 状态过多会产生什么后果？怎样处理？

11、TCP协议如何保证可靠性？

12、详细讲一下TCP的滑动窗口？

13、详细讲一下拥塞控制？





## 操作系统相关    [ref](/操作系统/操作系统)

1. 进程和线程的区别？
2. 协程与线程的区别？
3. 并发和并行有什么区别？
4. 进程与线程的切换流程？
5. 为什么虚拟地址空间切换会比较耗时？
6. 进程间通信方式有哪些？
7. 进程间同步的方式有哪些？
8. 线程同步的方式有哪些？
9. 线程的分类？
10. 什么是临界区，如何解决冲突？
11. 什么是死锁？死锁产生的条件？
12. 进程调度策略有哪几种？
13. 进程有哪些状态？
14. 什么是分页？
15. 什么是分段？
16. 分页和分段有什区别？
17. 什么是交换空间？
18. 物理地址、逻辑地址、有效地址、线性地址、虚拟地址的区别?
19. 页面替换算法有哪些？
20. 什么是缓冲区溢出？有什么危害？
21. 什么是虚拟内存？
22. 虚拟内存的实现方式有哪些?
23. 讲一讲IO多路复用？
24. 硬链接和软链接有什么区别？
25. 中断的处理过程?
26. 中断和轮询有什么区别？
27. 什么是用户态和内核态？
28. 用户态和内核态是如何切换的?
29. Unix 常见的IO模型：
30. select、poll 和 epoll 之间的区别?

## redis

### 1 基础

1. 概念
2. 项目中哪些地方用了redis
3. 为什么reids快

### 2 数据类型

1. redis的数据类型有哪些
2. redis数据结构有哪些
3. sds和c语言的字符串数组有什么好处
4. dict为什么使用rehash，不使用红黑树

### 3 持久化

1.  持久化有什么方法？具体过程
2.  RDB和AOF的使用场景

### 4 事务

1.  redis事务
2.  事务命令出错了，怎么办

### 5 缓存及一致性、雪崩、击穿与穿透问题

1. 缓存一致性问题

   > 先删后改+过期

2. 缓存雪崩

3. 缓存穿透

4. 缓存击穿

5. 布隆过滤器的原理是什么？

6.  布隆过滤器的01数组发生哈希冲突怎么办？

### 6 淘汰策略、删除策略

1. 内存满了如何处理？8种淘汰策略
2. key过期了如何处理？3种删除策略

## spring：

循环依赖如何解决？

A中有B，B中有A，给A加上@Lazy之后，B就能正常初始化了吗？

spring三级缓存了解吗？

8.Spring的两大特性，AOP的原理
9.Springboot相比Spring的优化之处
10.@configuration和@bean联合使用代替xml

## Mybatis

6.MybatisPlus如何进行sql查询的？
7.MybatisPlus的动态sql

## 分布式

1. 分布式下线程安全问题如何解决？

   redis分布式锁setnx，zk实现分布式锁

   https://juejin.cn/post/7038473714970656775#heading-2

   ​

2. 宕机/重启死锁问题

   线程t1获取的了分布式锁lock1，此时由于各种问题导致线程t1所在的机器宕机或者重启，导致没有释放分布式锁lock1，使得其他线程无法获取lock1，导致死锁问题。

   超时失效机制，给分布式锁加上过期时间

   ​

3. 加锁与过期时间原子性问题

   由于redis处理客户端指令采用单线程多路复用的方式，因此加锁与设置过期时间存在原子性问题。

   > 1. 使用lua脚本，通过Lua语言编写脚本执行，redis是支持lua脚本执行的，会把lua编译成sha指令，支持同时执行多条指令
   > 2. 使用redis自带的原子性命令，`set key value ex 100 nx`

4. 分布式锁时间长短问题

   - 设置时间过长，获取锁的线程死亡后，其他线程也要等待额定的时间，用户体验不好
   - 设置时间过短，会造成ABC问题

   > 开启一条子线程，间隔2-3s去查询一次Key是否过期，如果过期了则代表业务线程已经释放了锁，如果未过期，代表业务线程还在执行业务，那么则对于key的过期时间再加上5S秒钟。为了避免业务线程死亡，当前子线程一直续命，造成“长生锁”导致死锁的情况出现，可以把子线程变为业务线程的守护线程

   ​

5. 获取锁与释放锁一致性

   加锁线程和释放锁出现不是同一个线程问题

   > 在获取锁的时候，把写入redis的value值换成一个随机的UUID，然后在释放锁之前，先判断一下是否为当前线程加的锁，确实为当前线程加的锁那么则释放，反之抛出异常。


6. 主从架构锁失效

   由于某些情况导致主节点在线程t1获取锁后还未同步数据出现主从切换，这时主节点没有线程t1获取锁情况，导致可能出现多个线程获取锁

   >红锁算法、额外记录锁状态、zk锁
   >
   >https://juejin.cn/post/7038473714970656775#heading-9

   ​

7. Redisson框架 https://juejin.cn/post/7038473714970656775#heading-10

## 智力题

1. 1000个🍎放到一些箱子里 用最少的箱子来实现如果有人要购买任意数量的苹果，能不拆开箱子整箱卖出去。

   > 二进制，第一个箱子装1个，第二个箱子装2个，第三个箱子装4个，...，第10个箱子装512-24 = 488

2. 有8瓶液体，其中一瓶是毒药，毒性可使小白鼠饮用后在20小时内阵亡，需要几只小白鼠才能在20小时内判断哪一瓶是毒药？

   > 二进制，三位二进制标记瓶号000， 001，...，010，...，110，...
   >
   > 第一只引用第一位比特为1的毒药，
   >
   > 第2只引用第2位比特为1的毒药，
   >
   > 第3只引用第3位比特为1的毒药
   >
   > 如果都没有死，则是000编号的药瓶有毒
   >
   > 否则奖死亡小鼠引用的比特位赋值，第一只死则第一位赋值为1，以此类推
   >
   > ​