## 集合运算

在关系数据库中，数据操作主要包括查询和更新两大类。关系数据语言有关系代数语言，关系演算语言、具有关系代数和关系演算双重特点的语言三种。其中关系演算语言又包括元组关系演算语言，域关系演算语言。


传统的集合运算是二目运算，包括并、交、差、广义笛卡尔积四种运算。

（1）并。设关系R和S具有相同的关系模式，R和S的并是由属于R或属于S的元组组成的集合，记为R∪S。形式定义如下：

$$
R \cup S \equiv\{t \mid t \in R \vee t \in S\}
$$


式中 t是元组变量（下同）。显然，$R \cup S=S \cup R$。
（2）差。关系R和S具有相同的关系模式，R和S 的差是由属于R但不属于S的元组组成的集合，记为R-S。形式定义如下：
$$
R-S \equiv\{t \mid t \in R \wedge t \notin S\}
$$


（3）交。关系R和S具有相同的关系模式，R和S的交是由既属于R又属于S的元组组成的集合，记为R∩S。形式定义如下：
$$
R \cap S \equiv\{t \mid t \in R \wedge t \in S\}
$$


显然，R∩S = R-（R-S），或者R∩S = S-（S-R）。

（4）笛卡尔积。设关系R和S元数分别为r和s。R和S的笛卡尔积是一个r+s元的元组集合，每个元组的前r个分量来自R的一个元组，后 s个分量来自S的一个元组，记为R×S。形成定义如下：
$$
R \times S \equiv\left\{t \mid t=<t_{r}, t_{s}>\wedge t_{r} \in R \wedge t_{s} \in S\right\}
$$


若R有m个元组，S有n个元组，则R×S有m×n个元组。
（5）集合运算实例。例如，设关系R和S如表3-1所示。则R∪S与R∩S如表3-2所示，R-S和S-R，如表3-3所示，R×S分别如表3-4所示。
![输入图片说明](https://foruda.gitee.com/images/1680865984638141339/993e5808_8616658.png "屏幕截图")

![输入图片说明](https://foruda.gitee.com/images/1680866037680698481/09a58c50_8616658.png "屏幕截图")



## 关系运算


在3.4.1节的集合运算基础上，关系数据库还有一些专门的运算，主要有投影、选择、连接、除法和外连接。它们是关系代数最基本的操作，也是一个完备的操作集。在关系代数中，由五种基本代数操作经过有限次复合的式子称为关系代数运算表达式。表达式的运算结果仍是一个关系。我们可以用关系代数表达式表示各种数据查询和更新处理操作。

（1）投影。投影操作从关系R中选择出若干属性列组成新的关系，该操作对关系进行垂直分

割，消去某些列，并重新安排列的顺序，再删去重复元组。记作：
$$
\pi_{A}\left(R\right)\equiv\left\{t[A]\mid t\in R\right\}
$$



其中A为R的属性列。

（3）选择。选择操作在关系R中选择满足给定条件的所有元组，记作：
$$
\sigma_F(R)=\left\{t\mid t\in R\wedge F(t)=true\right\}\quad
$$
其中F表示选择条件，是一个逻辑表达式（逻辑运算符+算术表达式 ）。选择运算是从行的角度进行的运算。

（3）θ连接。θ连接从两个关系的笛卡儿积中选取属性间满足一定条件的元组记作：
$$
\quad R\succ_{A\theta}S=\{t,t,\mid t,\in R\land t,\in S\land t,[A]\theta t,[B]\}\quad
$$


其中A和B分别为R和S上度数相等且可比的属性组。θ为“=”的连接，称作等值连接，记作：

如果两个关系中进行比较的分量必须是相同的属性组，并且在结果中把重复的属性列去掉，则

称为自然连接，记作：



（4）除法。设两个关系R和S的元数分别为r和s（设r>s>0），那么R÷S是一个（r-s）元的元组
的集合。(R÷S)是满足下列条件的最大关系：其中每个元组t与S中每个元组u组成新元组<t，u>必在
关系R中。其具体计算公式如下：

（5）外联接。两个关系R和S进行自然连接时，选择两个关系R和S公共属性上相等的元组，去

掉重复的属性列构成新关系。这样，关系R中的某些元组有可能在关系S中不存在公共属性值上相等

的元组，造成关系R中这些元组的值在运算时舍弃了；同样关系S中的某些元组也可能舍弃。为此，

扩充了关系运算左外连接、右外连接和完全外连接。

•左外连接：R和S进行自然连接时，只把R中舍弃的元组放到新关系中。

•右外连接：R和S进行自然连接时，只把S中舍弃的元组放到新关系中。

•完全外连接：R和S进行自然连接时，只把R和S中舍弃的元组都放到新关系中。

（6）关系运算实例。设两个关系模式R和S如表3-5所示，则 的结果如表3-6所示，

的如表3-7所示， 的结果如图3-8所示，R与S的左外连接如表3-9所示，R与S的右

外连接如表3-10所示，R与S的完全外连接如表3-11所示。

表3-5 关系R和S

表3-6 对关系R求投影操作

表3-7 对关系R求选择操作