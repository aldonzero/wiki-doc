### 分层

![输入图片说明](https://foruda.gitee.com/images/1679379401544968336/b568434d_8616658.png "屏幕截图")

## 协议

### 数据链路层

点对点隧道协议（PPTP，Point-to-Point Tunneling Protocol）：用于将PPP分组通过IP网络封装传输，以实现虚拟专网（VPN），工作在数据链路层。

### 网络层

水平分割法：路由器从某个接收口接收到更新信息，不允许再从这个接口发出去

- 组织路由器环路的产生
- 减少路由器更新信息占用链路带宽资源。

IPSec

### 会话层

Socks

### 应用层

SSH

### DNS

- 递归查询：服务器返回的是和目标域名对应的IP

- 迭代查询：返回的结果可能是目标IP，也可能是下一次要查询的DNS服务器的地址

  ![输入图片说明](https://foruda.gitee.com/images/1679379733481529505/44f3bd79_8616658.png "屏幕截图")

注意：本机首先查的是本机的hosts文件，一般采用迭代的方式查询

### 网络故障诊断

- ping：用于检查网络是否连通

- tracert（linux：traceroute）：用于确定IP数据包访问的目标所采用的路径，若网络不通，能定位到具体那个节点不通

- ipconfig(ifconfig)：显示TCP/IP网络配置值，如IP地址、MAC地址、网关地址等

- nslookup：查询DNS记录

- netstate：用于显示网络连接、路由表和网络接口信息

  ​



### TCP三次握手、四次挥手

- LISTEN：监听TCP端口的连接请求
- SYN-SENT：在发送连接请求后等待匹配的连接请求的状态（客户端）
- SYN-RECEIVED：服务端在收到和发送一个连接请求后等待对方对连接请求的确认（服务器）
- ESTABLISHED：代表建立一连接
- FIN-WAIT-1：等待远程TCP连接中断请求，或先前的连接中断请求的确认
- FIN-WAIT-2：从远程TCP等待连接中断请求
- CLOSE-WAIT：等待从本地用户发来的连接中断请求
- CLOSING：等待远程TCP对连接中断的确认
- LAST-ACK：等待原来的发向远程TCP的连接中断请求的确认
- TIME-WAIT：等待足够的时间以确保远程TCP接收到连接中断请求的确认
- CLOSED：没有任何连接状态

![输入图片说明](https://foruda.gitee.com/images/1679380460190184502/7cdd18ae_8616658.png "屏幕截图")

**第一次挥手**

- 当客户端（主动关闭方）调用 close 函数后，会将就会向服务端发送 FIN 报文，试图与服务端断开连接，此时客户端的连接进入到 `FIN_WAIT_1` 状态。
- 正常情况下，如果能及时收到服务端（被动关闭方）的 ACK，则会很快变为 `FIN_WAIT2`状态。
- 如果第一次挥手丢失或服务端响应丢失，那么客户端迟迟收不到被动方的 ACK 的话，也就会触发超时重传机制，重传 FIN 报文，重发次数由 `tcp_orphan_retries` 参数控制。当客户端重传 FIN 报文的次数超过 `tcp_orphan_retries` 后，就不再发送 FIN 报文，则会在等待一段时间（时间为上一次超时时间的 2 倍），如果还是没能收到第二次挥手，那么直接进入到 `close` 状态。

**第二次挥手**

- 当服务端收到客户端的第一次挥手后，就会先回一个 ACK 确认报文，此时服务端的连接进入到 `CLOSE_WAIT` 状态。
- ACK 报文是不会重传的，所以如果服务端的第二次挥手丢失了，客户端就会触发超时重传机制，重传 FIN 报文，直到收到服务端的第二次挥手，或者达到最大的重传次数。当客户端重传 FIN 报文的次数超过 `tcp_orphan_retries` 后，就不再发送 FIN 报文，则会在等待一段时间（时间为上一次超时时间的 2 倍），如果还是没能收到第二次挥手，那么直接进入到 `close` 状态。
- 当客户端收到第二次挥手，也就是收到服务端发送的 ACK 报文后，客户端就会处于 `FIN_WAIT2` 状态，在这个状态需要等服务端发送第三次挥手，也就是服务端的 FIN 报文。对于 close 函数关闭的连接，由于无法再发送和接收数据，所以`FIN_WAIT2` 状态不可以持续太久，而 `tcp_fin_timeout` 控制了这个状态下连接的持续时长，默认值是 60 秒。

**关闭连接**

- 当local user调用close关闭连接时，会将FIN加入到出段队列，之后队列不再接收local user发送的数据，client端进入到FIN-WAIT-1状态。队列中FIN之前包括FIN都会被确认。服务端会对客户端的ACK立即确认，但是不会立即发送FIN，只有服务端的local user关闭了连接才会发送FIN
- 如果接收到了FIN请求，会告知local user连接正在关闭，local user会响应close，当队列中的所有数据发送完毕后会发送FIN给连接请求的一端（客户端），服务端会在FIN得到确认后将连接删除。如果在超时没有得到FIN的确认，会终止这个连接，并告知这个连接不可用。
- TCP的两端可以确认对方可以接收到FIN的确认后，删除连接



## DHCP

如果主机设置为自动获取IP地址，而又没有可用的DHCP服务器，那么主机会自动生成一个169.254.X.X的IP地址。

DHCP服务器提供三种IP分配方式：

- 自动分配（Automatic Allocation）
  自动分配是当DHCP客户端第一次成功地从DHCP服务器端分配到一个IP地址之后，就永远使用这个地址。
- 动态分配（Dynamic Allocation）
  动态分配是当DHCP客户端第一次从DHCP服务器分配到IP地址后，并非永久地使用该地址，每次使用完后，DHCP客户端就得释放这个IP地址，以给其他客户端使用。
- 手动分配
  手动分配是由DHCP服务器管理员专门为客户端指定IP地址。

## DNS

DNS服务配置中：

- A记录用于解析主机到IPV4地址
- MX记录指明邮件交换服务器的地址
- CNSME记录知名域名的地址
- AAAA记录将主机解析到IPV6地址

## OSPF

OSPF协议引入“分层路由”的概念，将网络分割成一个“主干”连接的组相互独立的部分（主干区域），这些相互独立的部分称为“区域（Area）”。每个区域如同一个独立的网络，该区域的OSPF路由只保存该区域的链路状态。整个网络成星形。

完全存根区域：不接受外部自治系统的路由以及自治系统内其他区域的路由，需要发送到域外的报文默认路由为：0.0.0.0.

## 划分子网

原网络后缀20，需要划分32个子网，即$2^{32} = 32$，需要增加5位。划分子网后的网络位长度= 原来网络位 + 子网位 = 20 + 5 = 25位，则掩码位255.255.255.128

## 综合布线系统

工作区子系统由信息插座、插座盒、连接跳线和适配器组成。
水平子系统由一个工作区的信息插座开始，经水平布置到管理区的内侧配线架的线缆所组成。是计算机设备和个管理子系统之间的连接
管理子系统由交连、互连配线架组成。管理子系统为连接其它子系统提供连接手段。
垂直干线子系统由建筑物内所有的垂直干线多对数电缆及相关支撑硬件组成，以提供设备间总配线架与干线接
线间楼层配线架之间的干线路由。
设备间子系统是由设备间中的电缆、连接器和有关的支撑硬件组成，作用是将计算机、PBX、摄像头、监视器
等弱电设备互连起来并连接到主配线架上。
建筑群子系统将一个建筑物的电缆延伸到另外一些建筑物中的通信设备和装置上

![输入图片说明](https://foruda.gitee.com/images/1679399263027240199/e6ed3779_8616658.png "屏幕截图")

## 信息安全

系统安全:

- 实体安全： 计算机相关设备、设施，实体安全主要避免自然灾害，可以分为环境安全、设备安全、和媒体安全。
- 运行安全：保证系统正常运行，包括系统风险管理、审计追从、备份回复、应急等
- 信息安全：信息相关。
- 人员安全：人员相关。

确保计算机系统机密性方法：加密、认证和授权。

数字签名用于保证发送方不可抵赖。

防火墙主要工作在网络层，支持地址转换和端口映射，通常部署在企业内网和Internet之间，具有网络隔离、路由、报文过滤功能，但不具备查杀病毒、过滤垃圾邮件等应用层功能。

无线加密技术WPA2中的加密算法是AES加密算法。

无线网络接入中采用WEP协议和WPA协议，底层采用RC4对称加密算法。

明文传输加密算法：RC-5

**加密算法**

RSA：非对称加密算法，公钥加密算法，推荐为公钥标准，但存在效率问题，一般不直接用于明文加密。

SHA：安全哈希算法主要适用于数字签名标准里面定义的数字签名算法，SHA-1会产生一个160位的消息摘要，当接收到消息的时候可以用来验证数据的完整性。

HMAC：密钥相关的哈希运算消息认证码，利用哈希算法，以一个密钥和一个消息为输入，生成一个消息摘要作为输出。

SHA-1、MD5：属于信息摘要算法，不能用于加密数据。

RC-5：对称加密，面向字结构，便于软件和硬件的实现，适用于不同字长的微处理器。

SSL：安全套接层，一种安全传输、保证数据完整的安全协议，处于应用层和传输层间。

AES：对称加密算法。

DES：对称加密算法，密钥只有56bit，易于被穷举攻击。

三重DES加密算法：使用两个密钥，两个密钥合起来有效长度位112bit，加密过程加密-解密-加密；解密过程：解密-加密-解密。



## 传输介质

### 光纤

单模光纤：中心玻璃细，只能传输一种模式的光前，比多模更远，超过5km；一般采用昂贵的激光光源。

多模：允许不同模式在一根光纤上传输，芯径较大，一般采用LED光源。

